{
	"info": {
		"_postman_id": "a1f19556-d0fe-4216-93b4-585345f316a6",
		"name": "eOCS-T2662-Update Incident Location",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "1555972",
		"_collection_link": "https://interstellar-eocs.postman.co/workspace/866d5192-de97-49ec-82d3-4bd25296b0f1/collection/1555972-a1f19556-d0fe-4216-93b4-585345f316a6?action=share&creator=1555972&source=collection_link"
	},
	"item": [
		{
			"name": "System Login",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const response = pm.response.json()\r",
							"\r",
							"//We are checking here if we logged in successfully and the response is as expected\r",
							"pm.test(\"Login is successful\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"    pm.expect(response).to.be.an(\"object\")\r",
							"    pm.expect(response).to.have.any.keys('authProfileId')\r",
							"    pm.expect(response).to.have.any.keys('needPWChange')\r",
							"\r",
							"});\r",
							"\r",
							"//If we get 403 status code, it means we do not have default auth profile\r",
							"pm.test('Check Status 403', () => {\r",
							"    if(pm.response.code === 403) {\r",
							"        console.log(\"You should set Default Authorization Profile of user first\")\r",
							"    }\r",
							"})\r",
							"\r",
							"//If we get 400 status code, it means you should logout first\r",
							"pm.test('Check Status 400', () => {\r",
							"    if(pm.response.code === 400) {\r",
							"        console.log(\"You should logout first\")\r",
							"    }\r",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"username\":\"BAO\",\"password\":\"BAO\"}"
				},
				"url": {
					"raw": "https://{{system}}-main.apps.ef-dev.at/api/login",
					"protocol": "https",
					"host": [
						"{{system}}-main",
						"apps",
						"ef-dev",
						"at"
					],
					"path": [
						"api",
						"login"
					]
				},
				"description": "Please do not delete \"system\" variable. Just update it with the system you are testing in EOCS-T2662-Update Incident Location folder ->Variables tab like in the picture.\n\nWith this request, we are logging. I**n this request, I used BAO user but you can change it in Body tab as in the picture.**\n\n<img src=\"https://content.pstmn.io/4f215a7f-edfc-4c90-a453-005e96bb436a/aW1hZ2UucG5n\" alt=\"User%20config\">\n\nIf you get 403 status code, you should select default auth profile for special user you are using.\n\nIf you get 400 status code, you should first logout. Just send Extra Step -Logout from System request."
			},
			"response": []
		},
		{
			"name": "Step 3-Add Incident Location Copy",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"    if(pm.response.code === 200) {\r",
							"        postman.setNextRequest(\"Step 3-Add Incident Location\")\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.test(\"Response body is ok\", function () {\r",
							"    var jsonData = pm.response.json();\r",
							"    pm.expect(jsonData).to.be.ok;\r",
							"});\r",
							"\r",
							"pm.test('Check Status 400', () => {\r",
							"    if(pm.response.code === 400) {\r",
							"        postman.setNextRequest(\"Extra Step -Logout from System\")\r",
							"    }\r",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "PUT",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n    \"additionalFields\": [\r\n        {\r\n            \"brickFieldDefinitionType\": \"USER_DEFINED\",\r\n            \"brickFieldType\": \"TEXT\",\r\n            \"fieldName\": \"Additional Info\",\r\n            \"horizontalPercent\": 100,\r\n            \"id\": \"6e47c6d3-77e0-47c3-b4ac-74b004cd89b7@026c85f8-16f5-486f-81e0-c046d1faea1f@dc39590a-649b-4e4a-b8a3-9b5ccfcb0135\",\r\n            \"identifier\": \"Additional Info\",\r\n            \"name\": \"UiBrick UiBrickAdditionalFieldData\",\r\n            \"searchable\": true,\r\n            \"selectionListFreeText\": false,\r\n            \"@type\": \"c5452e03-a09a-4887-b8ca-64b73952636b@com.eurofunk.eocs.uibrick.dto.UiBrickAdditionalFieldData\"\r\n        },\r\n        {\r\n            \"brickFieldDefinitionType\": \"AREA_TYPE\",\r\n            \"brickFieldType\": \"TEXT\",\r\n            \"fieldName\": \"Polizeidirektion\",\r\n            \"fieldValue\": \"PD GIESSEN\",\r\n            \"horizontalPercent\": 80,\r\n            \"id\": \"6e47c6d3-77e0-47c3-b4ac-74b004cd89b7@026c85f8-16f5-486f-81e0-c046d1faea1f@40b8f0c8-8192-4220-9f09-b38d8c4e8648\",\r\n            \"name\": \"UiBrick UiBrickAdditionalFieldData\",\r\n            \"searchable\": false,\r\n            \"selectionListFreeText\": false,\r\n            \"@type\": \"c5452e03-a09a-4887-b8ca-64b73952636b@com.eurofunk.eocs.uibrick.dto.UiBrickAdditionalFieldData\"\r\n        },\r\n        {\r\n            \"brickFieldDefinitionType\": \"AREA_TYPE\",\r\n            \"brickFieldType\": \"TEXT\",\r\n            \"fieldName\": \"PZB\",\r\n            \"fieldValue\": \"HEMH-GIESSEN-PST-NORD\",\r\n            \"horizontalPercent\": 20,\r\n            \"id\": \"6e47c6d3-77e0-47c3-b4ac-74b004cd89b7@026c85f8-16f5-486f-81e0-c046d1faea1f@44aecbe6-5778-4e41-8475-048a3f46a34b\",\r\n            \"name\": \"UiBrick UiBrickAdditionalFieldData\",\r\n            \"searchable\": false,\r\n            \"selectionListFreeText\": false,\r\n            \"@type\": \"c5452e03-a09a-4887-b8ca-64b73952636b@com.eurofunk.eocs.uibrick.dto.UiBrickAdditionalFieldData\"\r\n        }\r\n    ],\r\n    \"additionalObjectAddressDetails\": [\r\n        {\r\n            \"fromAddress\": {\r\n                \"id\": \"66ca4bed-dcc4-45ae-a630-a95543ca80ab\",\r\n                \"km\": \"24.002\",\r\n                \"streetId\": \"28309647-8e02-4ae7-adde-257dbf80013e\",\r\n                \"streetName\": \"A485 Langgöns - Gießener Nordkreuz (Westteil)\",\r\n                \"@type\": \"ff51cc43-d75c-41d8-a20d-9b1b29742f75@com.eurofunk.eocs.uibrick.dto.UiBrickAdditionalAddressDetails\"\r\n            },\r\n            \"id\": \"a9ddea8e-01f3-4c4c-8054-a60513879555\",\r\n            \"@type\": \"38af238a-89a0-4327-ab1c-b71b6f5b77d9@com.eurofunk.eocs.uibrick.dto.UiBrickAdditionalObjectAddressDetails\"\r\n        }\r\n    ],\r\n    \"addressDetails\": {\r\n        \"addressSecurityLevel\": 0,\r\n        \"city\": {\r\n            \"id\": \"945daf1d-6d97-478c-bf81-b4e0d3dd6d8f\",\r\n            \"name\": \"Gießen\",\r\n            \"visibleForUser\": false,\r\n            \"securityLevel\": 0\r\n        },\r\n        \"postalCode\": \"35398\",\r\n        \"street\": {\r\n            \"id\": \"28309647-8e02-4ae7-adde-257dbf80013e\",\r\n            \"name\": \"A485 Langgöns - Gießener Nordkreuz (Westteil)\",\r\n            \"visibleForUser\": false,\r\n            \"securityLevel\": 0\r\n        },\r\n        \"streetNumber\": \"24.002\",\r\n        \"@type\": \"fba95af5-71d4-43a2-a602-e2f65b6f1550@com.eurofunk.eocs.uibrick.dto.UiBrickAddressDetails\"\r\n    },\r\n    \"areas\": [\r\n        {\r\n            \"areaId\": \"945daf1d-6d97-478c-bf81-b4e0d3dd6d8f\",\r\n            \"areaName\": \"Gießen\",\r\n            \"areaType\": {\r\n                \"id\": \"2530e212-d6c7-4ae4-a145-416c9290f32e\",\r\n                \"name\": \"Ort\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"3b4ae9c4-4160-44a4-9dd2-eb7691e69415\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"b766b2d9-2460-40c0-a3ae-76a46edf32ae\",\r\n            \"areaName\": \"35396\",\r\n            \"areaType\": {\r\n                \"id\": \"249343b9-f510-4738-a903-782358d8646a\",\r\n                \"name\": \"ZIP\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"4567ad91-38a6-4b49-863a-53bf8a3dc3fd\",\r\n            \"areaName\": \"HEMH-MITTELHESSEN-PAST\",\r\n            \"areaType\": {\r\n                \"id\": \"3d84c9d1-b6e5-46f5-8d49-19d618a43d73\",\r\n                \"name\": \"PZB-BAB\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"d493d307-e320-442b-865f-68e8d16a526f\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"61918d9c-72a1-42a1-8ec9-f482e8d64a86\",\r\n            \"areaName\": \"fiktiver Sektor HEMH-GIESSEN-PST-NORD\",\r\n            \"areaType\": {\r\n                \"id\": \"ebab621d-8596-4a3e-95a8-e55559ceaebb\",\r\n                \"name\": \"Fahndungssektor\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"9a52748d-34d6-4030-88de-366293dee82f\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"c0676f4a-3512-4249-aa7f-5c2ea3d35822\",\r\n            \"areaName\": \"Deutschland\",\r\n            \"areaType\": {\r\n                \"id\": \"e327849c-d76f-404c-ae97-fc8e1cd93b76\",\r\n                \"name\": \"Staat\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"720459d3-09ff-4835-96da-02163d70bcd3\",\r\n            \"areaName\": \"Hessen\",\r\n            \"areaType\": {\r\n                \"id\": \"3cb0fc42-47c4-4b7c-a8f4-97045b439bfa\",\r\n                \"name\": \"Bundesland\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"c0676f4a-3512-4249-aa7f-5c2ea3d35822\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"a3b69007-be9a-471f-8c82-a683eaef816d\",\r\n            \"areaName\": \"Regierungsbezirk Gießen\",\r\n            \"areaType\": {\r\n                \"id\": \"42304e67-67df-407b-926e-c5c237b4ddf8\",\r\n                \"name\": \"Regierungsbezirk\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"720459d3-09ff-4835-96da-02163d70bcd3\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"3b4ae9c4-4160-44a4-9dd2-eb7691e69415\",\r\n            \"areaName\": \"Gießen\",\r\n            \"areaType\": {\r\n                \"id\": \"8a1b722f-0d30-4921-8ff9-6e6b7661e525\",\r\n                \"name\": \"Landkreis\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"a3b69007-be9a-471f-8c82-a683eaef816d\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"d493d307-e320-442b-865f-68e8d16a526f\",\r\n            \"areaName\": \"PP Mittelhessen\",\r\n            \"areaType\": {\r\n                \"id\": \"ca9ff633-532e-4a06-8f31-f3be69ab1731\",\r\n                \"name\": \"Polizeipräsidium\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"715c4fad-2c0e-4424-9621-d4d8f9521160\",\r\n            \"areaName\": \"PD GIESSEN\",\r\n            \"areaType\": {\r\n                \"id\": \"4bfa69f4-ea05-4ccf-ac8f-575d01a47a4f\",\r\n                \"name\": \"Polizeidirektion\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"d493d307-e320-442b-865f-68e8d16a526f\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        },\r\n        {\r\n            \"areaId\": \"9a52748d-34d6-4030-88de-366293dee82f\",\r\n            \"areaName\": \"HEMH-GIESSEN-PST-NORD\",\r\n            \"areaType\": {\r\n                \"id\": \"5b8361b3-d0b5-4915-b45b-60500fbb3a4b\",\r\n                \"name\": \"PZB\",\r\n                \"visibleForUser\": false,\r\n                \"securityLevel\": 0\r\n            },\r\n            \"created\": 1688111473571,\r\n            \"parentAreaId\": \"715c4fad-2c0e-4424-9621-d4d8f9521160\",\r\n            \"securityLevel\": 0,\r\n            \"@type\": \"0eb4f041-28c7-4f45-86b1-3920269ffa41@com.eurofunk.eocs.uibrick.dto.UiBrickAddressAreaData\"\r\n        }\r\n    ],\r\n    \"brickGeometry\": {\r\n        \"geometries\": [\r\n            {\r\n                \"geometry\": {\r\n                    \"srid\": 4326,\r\n                    \"wkt\": \"POINT (8.714135581960033 50.6272059309423)\"\r\n                },\r\n                \"tags\": [\r\n                    \"ExactLocation\"\r\n                ]\r\n            }\r\n        ],\r\n        \"exactLocationDeviation\": 0.0\r\n    },\r\n    \"isChangedByMap\": false,\r\n    \"column\": 0,\r\n    \"considerObjectData\": true,\r\n    \"created\": \"2023-06-30T05:36:52.226Z\",\r\n    \"definitionId\": \"6e47c6d3-77e0-47c3-b4ac-74b004cd89b7@026c85f8-16f5-486f-81e0-c046d1faea1f\",\r\n    \"fieldValidationErrors\": [],\r\n    \"geom\": {\r\n        \"srid\": 4326,\r\n        \"wkt\": \"POINT (8.714135581960033 50.6272059309423)\"\r\n    },\r\n    \"id\": \"ceee2e02-1749-4842-81bf-47a6524e766e\",\r\n    \"incident\": {\r\n        \"id\": \"833fb8e9-6932-470a-a1c3-38575109362e\",\r\n        \"name\": \"\",\r\n        \"visibleForUser\": false,\r\n        \"securityLevel\": 0\r\n    },\r\n    \"locationType\": \"IncidentLocation\",\r\n    \"modified\": \"2023-06-30T07:51:14.166Z\",\r\n    \"name\": \"UiBrick UiBrickAddressData\",\r\n    \"object\": {\r\n        \"additionalObjectEntityTypes\": [],\r\n        \"id\": \"e5447702-aba1-49ed-9e24-b968896edb4c\",\r\n        \"name\": \"AB AS Gießener Nordkreuz (1)\",\r\n        \"objectEntityType\": {\r\n            \"id\": \"46264d19-90d5-4a3f-8208-e5295896388f\",\r\n            \"name\": \"Autobahnanschlußstelle\",\r\n            \"visibleForUser\": false,\r\n            \"@type\": \"e1c90468-0df3-44d4-8ff1-17713c2713da@com.eurofunk.eocs.objects.dto.ObjectEntityTypeListInfoDTO\"\r\n        },\r\n        \"visibleForUser\": false,\r\n        \"@type\": \"127778ed-d5e9-4342-8b6d-a2405a734104@com.eurofunk.eocs.objects.dto.ObjectEntityListInfoDTO\"\r\n    },\r\n    \"removable\": false,\r\n    \"streetOutOfCity\": false,\r\n    \"titleFormat\": \"Location\",\r\n    \"titleValues\": [\r\n        \"Location\"\r\n    ],\r\n    \"validateWithoutException\": false,\r\n    \"version\": 0,\r\n    \"@type\": \"4b0b3bd9-c8aa-4ddd-8f1d-a00435a6fa16@com.eurofunk.eocs.uibrick.dto.UiBrickAddressData\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://{{system}}-main.apps.ef-dev.at/api/incidents/:incidentId/uibrickdata/:ubrickId",
					"protocol": "https",
					"host": [
						"{{system}}-main",
						"apps",
						"ef-dev",
						"at"
					],
					"path": [
						"api",
						"incidents",
						":incidentId",
						"uibrickdata",
						":ubrickId"
					],
					"variable": [
						{
							"key": "incidentId",
							"value": "833fb8e9-6932-470a-a1c3-38575109362e"
						},
						{
							"key": "ubrickId",
							"value": "ceee2e02-1749-4842-81bf-47a6524e766e"
						}
					]
				},
				"description": "With this request, we are updating Incident Location.\n\nPUT request uses 2 IDs: one Incident ID and another one UIBrickdata but you have to look up in devtools in the browser and update IncidentId. Most probably, ubrickid should be same but it would be better, if you check it.\n\nIn Body tab, the location data exists, so you can change it again by looking from devtools.\n\nYou can first set a location via browser in Incident and find this request in devtools and copy the request body from there. Then you can paste it in Body tab of this request.\n\nWith this request I only intended to change postalCode with 35396.\n\nFirst I set AB AS Gießener Nordkreuz (1) object in Location Brick in Incident on the system with User 1 and it has 35398 postalCode(ZIP field in Location Brick).\n\nAfter running this collection, it changes ZIP code from 35398 to 35396."
			},
			"response": []
		},
		{
			"name": "Extra Step -Logout from System Copy",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"You logged out successfuly\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"     \r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "https://{{system}}-main.apps.ef-dev.at/api/logout",
					"protocol": "https",
					"host": [
						"{{system}}-main",
						"apps",
						"ef-dev",
						"at"
					],
					"path": [
						"api",
						"logout"
					]
				},
				"description": "This request for logging out. You should see 200 OK status code."
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "system",
			"value": "",
			"type": "string"
		}
	]
}